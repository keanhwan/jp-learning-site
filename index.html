<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏùºÎ≥∏Ïñ¥ ÎßàÏä§ÌÑ∞ - Îß§Ïùº ÏùºÎ≥∏Ïñ¥ ÌïôÏäµ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            animation: fadeIn 0.5s ease-in;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .date-display {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-bottom: 20px;
        }

        .learning-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: slideUp 0.6s ease-out;
        }

        .calendar-section {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            height: fit-content;
            animation: slideUp 0.7s ease-out;
        }

        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .tab-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .tab-button.active {
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .japanese-text {
            font-size: 3em;
            color: #333;
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
        }

        .reading {
            font-size: 1.5em;
            color: #666;
            text-align: center;
            margin: 10px 0;
        }

        .meaning {
            font-size: 1.2em;
            color: #444;
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: rgba(255,255,255,0.5);
            border-radius: 10px;
        }

        .audio-button {
            display: block;
            margin: 20px auto;
            padding: 15px 30px;
            background: linear-gradient(135deg, #fa709a, #fee140);
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .audio-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .audio-button:active {
            transform: scale(0.95);
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-header {
            text-align: center;
            font-weight: bold;
            padding: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .calendar-day:hover {
            background: #f0f0f0;
            transform: scale(1.1);
        }

        .calendar-day.has-data {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
        }

        .calendar-day.today {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            font-weight: bold;
        }

        .weekday-label {
            text-align: center;
            font-weight: bold;
            color: #666;
            padding: 5px;
            font-size: 0.8em;
        }

        .quiz-section {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            padding: 30px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .quiz-question {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .quiz-option {
            padding: 15px;
            background: white;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.1em;
        }

        .quiz-option:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .quiz-option.correct {
            background: #4caf50;
            color: white;
        }

        .quiz-option.incorrect {
            background: #f44336;
            color: white;
        }

        .quiz-result {
            text-align: center;
            font-size: 1.2em;
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 10px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease-in;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 2em;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: #f44336;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .japanese-text {
                font-size: 2.5em;
            }
            
            .tab-button {
                padding: 10px 20px;
                font-size: 0.9em;
            }
            
            .quiz-options {
                grid-template-columns: 1fr;
            }
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üå∏ ÏùºÎ≥∏Ïñ¥ ÎßàÏä§ÌÑ∞ üáØüáµ</h1>
            <div class="date-display" id="dateDisplay"></div>
        </header>

        <div class="main-content">
            <div class="learning-section">
                <div class="tab-container">
                    <button class="tab-button active" onclick="showTab(this, 'word')">Ïò§ÎäòÏùò Îã®Ïñ¥</button>
                    <button class="tab-button" onclick="showTab(this, 'sentence')">Ïò§ÎäòÏùò Î¨∏Ïû•</button>
                    <button class="tab-button" onclick="showTab(this, 'kanji')">Ïò§ÎäòÏùò ÌïúÏûê</button>
                    <button class="tab-button" onclick="showTab(this, 'kana')">ÌûàÎùºÍ∞ÄÎÇò/Í∞ÄÌÉÄÏπ¥ÎÇò</button>
                    <button class="tab-button" onclick="showTab(this, 'quiz')">ÌÇ§Ï¶à</button>
                </div>

                <div id="word" class="tab-content active">
                    <div class="card">
                        <div class="japanese-text" id="wordText"></div>
                        <div class="reading" id="wordReading"></div>
                        <div class="meaning" id="wordMeaning"></div>
                        <button class="audio-button" onclick="speak('word')">üîä Î∞úÏùå Îì£Í∏∞</button>
                    </div>
                </div>

                <div id="sentence" class="tab-content">
                    <div class="card">
                        <div class="japanese-text" id="sentenceText"></div>
                        <div class="reading" id="sentenceReading"></div>
                        <div class="meaning" id="sentenceMeaning"></div>
                        <button class="audio-button" onclick="speak('sentence')">üîä Î∞úÏùå Îì£Í∏∞</button>
                    </div>
                </div>

                <div id="kanji" class="tab-content">
                    <div class="card">
                        <div class="japanese-text" id="kanjiText"></div>
                        <div class="reading" id="kanjiReading"></div>
                        <div class="meaning" id="kanjiMeaning"></div>
                        <button class="audio-button" onclick="speak('kanji')">üîä Î∞úÏùå Îì£Í∏∞</button>
                    </div>
                </div>

                <div id="kana" class="tab-content">
                    <div class="card">
                        <h3 style="text-align: center; margin-bottom: 20px; color: #667eea;">Ïò§ÎäòÏùò ÌûàÎùºÍ∞ÄÎÇò</h3>
                        <div class="japanese-text" id="hiraganaText"></div>
                        <div class="reading" id="hiraganaRomaji"></div>
                        <button class="audio-button" onclick="speakKana('hiragana')">üîä Î∞úÏùå Îì£Í∏∞</button>
                    </div>
                    <div class="card">
                        <h3 style="text-align: center; margin-bottom: 20px; color: #764ba2;">Ïò§ÎäòÏùò Í∞ÄÌÉÄÏπ¥ÎÇò</h3>
                        <div class="japanese-text" id="katakanaText"></div>
                        <div class="reading" id="katakanaRomaji"></div>
                        <button class="audio-button" onclick="speakKana('katakana')">üîä Î∞úÏùå Îì£Í∏∞</button>
                    </div>
                </div>

                <div id="quiz" class="tab-content">
                    <div class="quiz-section">
                        <h3 style="text-align: center; margin-bottom: 20px;">ÏµúÍ∑º 2ÏùºÍ∞Ñ Î∞∞Ïö∞Îäî ÎÇ¥Ïö© ÌÇ§Ï¶à</h3>
                        <div class="quiz-question" id="quizQuestion"></div>
                        <div class="quiz-options" id="quizOptions"></div>
                        <div class="quiz-result" id="quizResult"></div>
                        <button class="audio-button" onclick="nextQuiz()">Îã§Ïùå Î¨∏Ï†ú</button>
                    </div>
                </div>

                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="studyDays">0</div>
                        <div class="stat-label">ÌïôÏäµÏùºÏàò</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="wordsLearned">0</div>
                        <div class="stat-label">ÌïôÏäµ Îã®Ïñ¥</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="quizScore">0%</div>
                        <div class="stat-label">ÌÇ§Ï¶à Ï†ïÎãµÎ•†</div>
                    </div>
                </div>
            </div>

            <div class="calendar-section">
                <div class="calendar-header" id="calendarMonth"></div>
                <div class="calendar" id="calendar"></div>
            </div>
        </div>
    </div>

    <div class="modal" id="reviewModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 style="text-align: center; margin-bottom: 20px; color: #667eea;">Î≥µÏÑùÌïòÍ∏∞</h2>
            <div id="reviewContent"></div>
        </div>
    </div>

    <script>
        // ÌïôÏäµ Îç∞Ïù¥ÌÑ∞
        const learningData = {
            '2025-01-07': {
                word: { text: 'Ê°ú', reading: '„Åï„Åè„Çâ', meaning: 'Î≤πÍΩÉ' },
                sentence: { text: 'Ê°ú„ÅåÁ∂øÈ±è„Åß„Åô', reading: '„Åï„Åè„Çâ„Åå„Åç„Çå„ÅÑ„Åß„Åô', meaning: 'Î≤πÍΩÉÏù¥ ÏïÑÎ¶ÑÎã¥ÎãàÎã§' },
                kanji: { text: 'Ëä±', reading: '„ÅØ„Å™', meaning: 'ÍΩÉ' },
                hiragana: { text: '„Åï', romaji: 'sa' },
                katakana: { text: '„Çµ', romaji: 'sa' }
            },
            '2025-01-08': {
                word: { text: 'Â≠¶Ê†°', reading: '„Åå„Å£„Åì„ÅÜ', meaning: 'ÌïôÍµê' },
                sentence: { text: 'Â≠¶Ê†°„Å´Ë°å„Åç„Åæ„Åô', reading: '„Åå„Å£„Åì„ÅÜ„Å´„ÅÑ„Åç„Åæ„Åô', meaning: 'ÌïôÍµêÏóê Í∞ÄÎã§' },
                kanji: { text: 'Â≠¶', reading: '„Åå„Åè', meaning: 'Î∞∞Ïö∞Îã§' },
                hiragana: { text: '„Åå', romaji: 'ga' },
                katakana: { text: '„Ç¨', romaji: 'ga' }
            },
            '2025-01-09': {
                word: { text: 'ÂèãÈÅî', reading: '„Å®„ÇÇ„Å†„Å°', meaning: 'ÏπúÍµ¨' },
                sentence: { text: 'ÂèãÈÅî„Å®ÈÅä„Å≥„Åæ„Åô', reading: '„Å®„ÇÇ„Å†„Å°„Å®„ÅÇ„Åù„Å≥„Åæ„Åô', meaning: 'ÏπúÍµ¨ÏôÄ ÎÜçÎãàÎã§' },
                kanji: { text: 'Âèã', reading: '„Å®„ÇÇ', meaning: 'ÏπúÍµ¨' },
                hiragana: { text: '„Å®', romaji: 'to' },
                katakana: { text: '„Éà', romaji: 'to' }
            },
            '2025-01-10': {
                word: { text: 'Êú¨', reading: '„Åª„Çì', meaning: 'Ï±Ö' },
                sentence: { text: 'Êú¨„ÇíË™≠„Åø„Åæ„Åô', reading: '„Åª„Çì„Çí„Çà„Åø„Åæ„Åô', meaning: 'Ï±ÖÏùÑ ÏùΩÏäµÎãàÎã§' },
                kanji: { text: 'Êú¨', reading: '„Åª„Çì', meaning: 'Ï±Ö, Í∏∞Î≥∏' },
                hiragana: { text: '„Åª', romaji: 'ho' },
                katakana: { text: '„Éõ', romaji: 'ho' }
            }
        };

        // Ï∂îÍ∞Ä ÌïôÏäµ Îç∞Ïù¥ÌÑ∞ (Îß§Ïùº ÏàúÌôò)
        const additionalData = [
            {
                word: { text: 'Êúù', reading: '„ÅÇ„Åï', meaning: 'ÏïÑÏπòÎßà' },
                sentence: { text: 'Êúù„ÅîÈ£Ø„ÇíÈ£ü„Åπ„Åæ„Åô', reading: '„ÅÇ„Åï„Åî„ÅØ„Çì„Çí„Åü„Åπ„Åæ„Åô', meaning: 'ÏïÑÏπòÎßàÎπÑÎ•º Î®πÏäµÎãàÎã§' },
                kanji: { text: 'Êúù', reading: '„ÅÇ„Åï', meaning: 'ÏïÑÏπòÎßà' },
                hiragana: { text: '„ÅÇ', romaji: 'a' },
                katakana: { text: '„Ç¢', romaji: 'a' }
            },
            {
                word: { text: 'Â§ú', reading: '„Çà„Çã', meaning: 'Î∞§' },
                sentence: { text: 'Â§ú„ÅØÈùô„Åã„Åß„Åô', reading: '„Çà„Çã„ÅØ„Åó„Åö„Åã„Åß„Åô', meaning: 'Î∞§ÏùÄ Ï°∞Ïö©Ìï©ÎãàÎã§' },
                kanji: { text: 'Â§ú', reading: '„Çà„Çã', meaning: 'Î∞§' },
                hiragana: { text: '„Çà', romaji: 'yo' },
                katakana: { text: '„É®', romaji: 'yo' }
            },
            {
                word: { text: 'Ê∞¥', reading: '„Åø„Åö', meaning: 'Î¨º' },
                sentence: { text: 'Ê∞¥„ÇíÈ£≤„Åø„Åæ„Åô', reading: '„Åø„Åö„Çí„ÅÆ„Åø„Åæ„Åô', meaning: 'Î¨ºÏùÑ ÎßàÏûÖÎãàÎã§' },
                kanji: { text: 'Ê∞¥', reading: '„Åø„Åö', meaning: 'Î¨º' },
                hiragana: { text: '„Åø', romaji: 'mi' },
                katakana: { text: '„Éü', romaji: 'mi' }
            },
            {
                word: { text: 'Â±±', reading: '„ÇÑ„Åæ', meaning: 'ÏÇ∞' },
                sentence: { text: 'Â±±„Å´Áôª„Çä„Åæ„Åô', reading: '„ÇÑ„Åæ„Å´„ÅÆ„Åº„Çä„Åæ„Åô', meaning: 'ÏÇ∞Ïóê Ïò¨Î¶∞Îã§' },
                kanji: { text: 'Â±±', reading: '„ÇÑ„Åæ', meaning: 'ÏÇ∞' },
                hiragana: { text: '„ÇÑ', romaji: 'ya' },
                katakana: { text: '„É§', romaji: 'ya' }
            },
            {
                word: { text: 'Èõ®', reading: '„ÅÇ„ÇÅ', meaning: 'ÎπÑ' },
                sentence: { text: 'Èõ®„ÅåÈôç„Çä„Åæ„Åô', reading: '„ÅÇ„ÇÅ„Åå„Åµ„Çä„Åæ„Åô', meaning: 'ÎπÑÍ∞Ä ÎÇ¥Î¶∞Îã§' },
                kanji: { text: 'Èõ®', reading: '„ÅÇ„ÇÅ', meaning: 'ÎπÑ' },
                hiragana: { text: '„ÇÅ', romaji: 'me' },
                katakana: { text: '„É°', romaji: 'me' }
            }
        ];

        // Î©îÎ™®Î¶¨ Ï†ÄÏû•ÏÜå (localStorage ÎåÄÏ≤¥)
        let memoryStorage = JSON.parse(localStorage.getItem('jpMemory') || '{"studyDays":0,"wordsLearned":0,"quizCorrect":0,"quizTotal":0,"studyHistory":{}}');

        // ÌòÑÏû¨ ÎÇ†Ïßú Í∞ÄÏ†∏Ïò§Í∏∞
        function getCurrentDate() {
            return new Date().toISOString().split('T')[0];
        }

        // ÎÇ†Ïßú ÌëúÏãú
        function displayDate() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            document.getElementById('dateDisplay').textContent = now.toLocaleDateString('ko-KR', options);
        }

        // Ïò§ÎäòÏùò ÌïôÏäµ Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
        function getTodayData() {
            const today = getCurrentDate();
            if (!learningData[today]) {
                // ÎÇ†ÏßúÏóê Îî∞Îùº Ï∂îÍ∞Ä Îç∞Ïù¥ÌÑ∞ÏóêÏÑú ÏàúÌôò ÏÑ†ÌÉù
                const dayIndex = new Date().getDate() % additionalData.length;
                learningData[today] = additionalData[dayIndex];
            }
            return learningData[today];
        }

        // ÌïôÏäµ ÎÇ¥Ïö© ÌëúÏãú
        function displayLearningContent() {
            const todayData = getTodayData();
            
            // Îã®Ïñ¥
            document.getElementById('wordText').textContent = todayData.word.text;
            document.getElementById('wordReading').textContent = todayData.word.reading;
            document.getElementById('wordMeaning').textContent = todayData.word.meaning;
            
            // Î¨∏Ïû•
            document.getElementById('sentenceText').textContent = todayData.sentence.text;
            document.getElementById('sentenceReading').textContent = todayData.sentence.reading;
            document.getElementById('sentenceMeaning').textContent = todayData.sentence.meaning;
            
            // ÌïúÏûê
            document.getElementById('kanjiText').textContent = todayData.kanji.text;
            document.getElementById('kanjiReading').textContent = `ÏùåÎèÑ: ${todayData.kanji.reading}`;
            document.getElementById('kanjiMeaning').textContent = todayData.kanji.meaning;
            
            // ÌûàÎùºÍ∞ÄÎÇò/Í∞ÄÌÉÄÏπ¥ÎÇò
            document.getElementById('hiraganaText').textContent = todayData.hiragana.text;
            document.getElementById('hiraganaRomaji').textContent = todayData.hiragana.romaji;
            document.getElementById('katakanaText').textContent = todayData.katakana.text;
            document.getElementById('katakanaRomaji').textContent = todayData.katakana.romaji;
            
            // ÌïôÏäµ Í∏∞Î°ù Ï†ÄÏû•
            saveStudyRecord();
        }

        // ÌïôÏäµ Í∏∞Î°ù Ï†ÄÏû•
        function saveStudyRecord() {
            const today = getCurrentDate();
            if (!memoryStorage.studyHistory[today]) {
                memoryStorage.studyHistory[today] = getTodayData();
                memoryStorage.studyDays = Object.keys(memoryStorage.studyHistory).length;
                memoryStorage.wordsLearned = memoryStorage.studyDays * 3; // ÌïòÎ£®Ïóê 3Í∞ú Îã®Ïñ¥ ÌïôÏäµ
                updateStats();
            }
        }

                // ÌÜ†Í∏à ÏóÖÎç∞Ïù¥Ìä∏
        function updateStats() {
            document.getElementById('studyDays').textContent = memoryStorage.studyDays;
            document.getElementById('wordsLearned').textContent = memoryStorage.wordsLearned;
            
            if (memoryStorage.quizTotal > 0) {
                const percentage = Math.round((memoryStorage.quizCorrect / memoryStorage.quizTotal) * 100);
                document.getElementById('quizScore').textContent = percentage + '%';
            }
            localStorage.setItem('jpMemory', JSON.stringify(memoryStorage));
        }

        // ÌÉ≠ Ï†ÑÌôò
        function showTab(button, tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-button');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            button.classList.add('active');
            
            if (tabName === 'quiz') {
                initQuiz();
            }
        }

        // ÏùåÏÑ± ÌïµÏÑ±
        function speak(type) {
            const todayData = getTodayData();
            let text = '';
            
            switch(type) {
                case 'word':
                    text = todayData.word.reading;
                    break;
                case 'sentence':
                    text = todayData.sentence.reading;
                    break;
                case 'kanji':
                    text = todayData.kanji.reading;
                    break;
            }
            
            if ('speechSynthesis' in window) {
                // Ïù¥Ï†Ñ ÏùåÏÑ± Ï§ëÏßÄ
                window.speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP';
                utterance.rate = 0.8;
                
                // ÏùºÎ≥∏Ïñ¥ ÏùåÏÑ± Ï∞æÍ∏∞
                const voices = window.speechSynthesis.getVoices();
                const japaneseVoice = voices.find(voice => voice.lang.includes('ja'));
                if (japaneseVoice) {
                    utterance.voice = japaneseVoice;
                }
                
                window.speechSynthesis.speak(utterance);
            } else {
                alert('Ïù¥ Î∏åÎùºÏö∞Ï†ÄÎäî ÏùåÏÑ± ÌïµÏÑ±ÏùÑ ÏßÑÌñâÌïòÏßÄ ÏïäÏäµÎãàÎã§.');
            }
        }

        // Í∞ÄÎÇò ÏùåÏÑ±
        function speakKana(type) {
            const todayData = getTodayData();
            const text = type === 'hiragana' ? todayData.hiragana.text : todayData.katakana.text;
            
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP';
                utterance.rate = 0.6;
                
                const voices = window.speechSynthesis.getVoices();
                const japaneseVoice = voices.find(voice => voice.lang.includes('ja'));
                if (japaneseVoice) {
                    utterance.voice = japaneseVoice;
                }
                
                window.speechSynthesis.speak(utterance);
            }
        }

        // Îã¨Îü¨Í∏∞ ÏÉùÏÑ±
        function createCalendar() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();
            const today = now.getDate();
            
            // Ïõî ÌëúÏãú
            const monthNames = ['1Ïõî', '2Ïõî', '3Ïõî', '4Ïõî', '5Ïõî', '6Ïõî', '7Ïõî', '8Ïõî', '9Ïõî', '10Ïõî', '11Ïõî', '12Ïõî'];
            document.getElementById('calendarMonth').textContent = `${year}ÎÖÑ ${monthNames[month]}`;
            
            const calendar = document.getElementById('calendar');
            calendar.innerHTML = '';
            
            // ÏöîÏùº ÌëúÏãú
            const weekdays = ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'];
            weekdays.forEach(day => {
                const dayLabel = document.createElement('div');
                dayLabel.className = 'weekday-label';
                dayLabel.textContent = day;
                calendar.appendChild(dayLabel);
            });
            
            // Îπà Ïπ∏ Ï±ÑÏõåÍ∏∞
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                calendar.appendChild(emptyDay);
            }
            
            // ÎÇ†Ïßú Ï±ÑÏõåÍ∏∞
            for (let date = 1; date <= lastDate; date++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = date;
                
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(date).padStart(2, '0')}`;
                
                if (learningData[dateStr] || memoryStorage.studyHistory[dateStr]) {
                    dayElement.classList.add('has-data');
                }
                
                if (date === today) {
                    dayElement.classList.add('today');
                }
                
                dayElement.onclick = () => showReview(dateStr);
                calendar.appendChild(dayElement);
            }
        }

        // Î≥µÏÑù Î™©Î°ù ÌëúÏãú
        function showReview(dateStr) {
            const data = learningData[dateStr] || memoryStorage.studyHistory[dateStr];
            if (!data) {
                alert('Ïù¥ ÎÇ†ÏßúÏóêÎäî ÌïôÏäµ ÎÇ¥Ïö©Ïù¥ ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const modal = document.getElementById('reviewModal');
            const content = document.getElementById('reviewContent');
            
            content.innerHTML = `
                <div class="card">
                    <h3>Îã®Ïñ¥</h3>
                    <div class="japanese-text">${data.word.text}</div>
                    <div class="reading">${data.word.reading}</div>
                    <div class="meaning">${data.word.meaning}</div>
                </div>
                <div class="card">
                    <h3>Î¨∏Ïû•</h3>
                    <div class="japanese-text">${data.sentence.text}</div>
                    <div class="reading">${data.sentence.reading}</div>
                    <div class="meaning">${data.sentence.meaning}</div>
                </div>
                <div class="card">
                    <h3>ÌïúÏûê</h3>
                    <div class="japanese-text">${data.kanji.text}</div>
                    <div class="reading">ÏùåÎèÑ: ${data.kanji.reading}</div>
                    <div class="meaning">${data.kanji.meaning}</div>
                </div>
            `;
            
            modal.style.display = 'block';
        }

        // Î™©Î°ù Îã´Í∏∞
        function closeModal() {
            document.getElementById('reviewModal').style.display = 'none';
        }

        // ÌÇ§Ï¶à Î≥ÄÏàò
        let currentQuizData = [];
        let currentQuizIndex = 0;
        let currentQuizAnswer = '';

        // ÌÇ§Ï¶à Ï¥àÍ∏∞Ìôî
        function initQuiz() {
            currentQuizData = [];
            const today = new Date();
            
            // ÏµúÍ∑º 2ÏùºÍ∞ÑÏùò Îç∞Ïù¥ÌÑ∞ ÏàòÏßë
            for (let i = 0; i <= 2; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                
                if (learningData[dateStr] || memoryStorage.studyHistory[dateStr]) {
                    const data = learningData[dateStr] || memoryStorage.studyHistory[dateStr];
                    currentQuizData.push({
                        question: data.word.text,
                        answer: data.word.meaning,
                        type: 'word'
                    });
                    currentQuizData.push({
                        question: data.kanji.text,
                        answer: data.kanji.meaning,
                        type: 'kanji'
                    });
                }
            }
            
            if (currentQuizData.length > 0) {
                currentQuizIndex = 0;
                showQuizQuestion();
            } else {
                document.getElementById('quizQuestion').textContent = 'ÏïÑÏßÅ ÌÇ§Ï¶àÎ•º Ìë∏Î†• Ïàò ÏûàÎäî ÌïôÏäµ ÎÇ¥Ïö©Ïù¥ ÏóÜÏäµÎãàÎã§.';
                document.getElementById('quizOptions').innerHTML = '';
                document.getElementById('quizResult').textContent = '';
            }
        }

        // ÌÇ§Ï¶à Î¨∏Ï†ú ÌëúÏãú
        function showQuizQuestion() {
            if (currentQuizIndex >= currentQuizData.length) {
                currentQuizIndex = 0;
            }
            
            const quiz = currentQuizData[currentQuizIndex];
            currentQuizAnswer = quiz.answer;
            
            document.getElementById('quizQuestion').textContent = `"${quiz.question}"Ïùò Îî∞ÏúÑÎäî?`;
            document.getElementById('quizResult').textContent = '';
            
            // ÏÑ†ÌÉùÏßÄ ÏÉùÏÑ±
            const options = [quiz.answer];
            const wrongAnswers = ['ÏÇ¨Îûë', 'ÌïòÎäò', 'Î∞îÎã§', 'ÏãúÍ∞Ñ', 'ÎßàÏùå', 'Í∏∏', 'Ïßë', 'ÏÇ¨Îûå', 'ÏùåÏãù', 'ÎÇ§Ïî®'];
            
            while (options.length < 4) {
                const wrongAnswer = wrongAnswers[Math.floor(Math.random() * wrongAnswers.length)];
                if (!options.includes(wrongAnswer)) {
                    options.push(wrongAnswer);
                }
            }
            
            // ÏÑ†ÌÉùÏßÄ ÏÑûÍ∏∞
            options.sort(() => Math.random() - 0.5);
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            options.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option';
                optionElement.textContent = option;
                optionElement.onclick = () => checkAnswer(option, optionElement);
                optionsContainer.appendChild(optionElement);
            });
        }

        // Îãµ Ï≤¥ÌÅ¨
        function checkAnswer(answer, element) {
            const options = document.querySelectorAll('.quiz-option');
            options.forEach(opt => opt.onclick = null);
            
            if (answer === currentQuizAnswer) {
                element.classList.add('correct');
                document.getElementById('quizResult').textContent = 'Ï†ïÎãµÏûÖÎãàÎã§! üéâ';
                memoryStorage.quizCorrect++;
            } else {
                element.classList.add('incorrect');
                options.forEach(opt => {
                    if (opt.textContent === currentQuizAnswer) {
                        opt.classList.add('correct');
                    }
                });
                document.getElementById('quizResult').textContent = `ÌäµÎãπÏûÖÎãàÎã§. Ï†ïÎãµÏùÄ "${currentQuizAnswer}"ÏûÖÎãàÎã§.`;
            }
            
            memoryStorage.quizTotal++;
            updateStats();
        }

        // Îã§Ïùå ÌÇ§Ï¶à
        function nextQuiz() {
            currentQuizIndex++;
            showQuizQuestion();
        }

        // Ï¥àÍ∏∞Ìôî
        window.onload = function() {
            displayDate();
            displayLearningContent();
            createCalendar();
            updateStats();
            
            // ÏùåÏÑ± Ï§ÄÎπÑ
            if ('speechSynthesis' in window) {
                window.speechSynthesis.getVoices();
            }
            
            // Î™©Î°ù Ïô∏Î∂Ä ÌÅ¥Î¶ΩÏãú Îã´Í∏∞
            window.onclick = function(event) {
                const modal = document.getElementById('reviewModal');
                if (event.target === modal) {
                    closeModal();
                }
            }
        };
    </script>
</body>
</html>
