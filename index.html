<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¼ë³¸ì–´ ë§ˆìŠ¤í„° - ë§¤ì¼ ì¼ë³¸ì–´ í•™ìŠµ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            animation: fadeIn 0.5s ease-in;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .date-display {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-bottom: 20px;
        }

        .learning-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: slideUp 0.6s ease-out;
        }

        .calendar-section {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            height: fit-content;
            animation: slideUp 0.7s ease-out;
        }

        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .tab-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .tab-button.active {
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .japanese-text {
            font-size: 3em;
            color: #333;
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
        }

        .reading {
            font-size: 1.5em;
            color: #666;
            text-align: center;
            margin: 10px 0;
        }

        .meaning {
            font-size: 1.2em;
            color: #444;
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: rgba(255,255,255,0.5);
            border-radius: 10px;
        }

        .audio-button {
            display: block;
            margin: 20px auto;
            padding: 15px 30px;
            background: linear-gradient(135deg, #fa709a, #fee140);
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .audio-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .audio-button:active {
            transform: scale(0.95);
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-header {
            text-align: center;
            font-weight: bold;
            padding: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .calendar-day:hover {
            background: #f0f0f0;
            transform: scale(1.1);
        }

        .calendar-day.has-data {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
        }

        .calendar-day.today {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            font-weight: bold;
        }

        .weekday-label {
            text-align: center;
            font-weight: bold;
            color: #666;
            padding: 5px;
            font-size: 0.8em;
        }

        .quiz-section {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            padding: 30px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .quiz-question {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .quiz-option {
            padding: 15px;
            background: white;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.1em;
        }

        .quiz-option:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .quiz-option.correct {
            background: #4caf50;
            color: white;
        }

        .quiz-option.incorrect {
            background: #f44336;
            color: white;
        }

        .quiz-result {
            text-align: center;
            font-size: 1.2em;
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 10px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease-in;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 2em;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: #f44336;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .japanese-text {
                font-size: 2.5em;
            }
            
            .tab-button {
                padding: 10px 20px;
                font-size: 0.9em;
            }
            
            .quiz-options {
                grid-template-columns: 1fr;
            }
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸŒ¸ ì¼ë³¸ì–´ ë§ˆìŠ¤í„° ğŸ‡¯ğŸ‡µ</h1>
            <div class="date-display" id="dateDisplay"></div>
        </header>

        <div class="main-content">
            <div class="learning-section">
                <div class="tab-container">
                    <button class="tab-button active" onclick="showTab(this, 'word')">ì˜¤ëŠ˜ì˜ ë‹¨ì–´</button>
                    <button class="tab-button" onclick="showTab(this, 'sentence')">ì˜¤ëŠ˜ì˜ ë¬¸ì¥</button>
                    <button class="tab-button" onclick="showTab(this, 'kanji')">ì˜¤ëŠ˜ì˜ í•œì</button>
                    <button class="tab-button" onclick="showTab(this, 'kana')">íˆë¼ê°€ë‚˜/ê°€íƒ€ì¹´ë‚˜</button>
                    <button class="tab-button" onclick="showTab(this, 'quiz')">í‚¤ì¦ˆ</button>
                </div>

                <div id="word" class="tab-content active">
                    <div class="card">
                        <div class="japanese-text" id="wordText"></div>
                        <div class="reading" id="wordReading"></div>
                        <div class="meaning" id="wordMeaning"></div>
                        <button class="audio-button" onclick="speak('word')">ğŸ”Š ë°œìŒ ë“£ê¸°</button>
                    </div>
                </div>

                <div id="sentence" class="tab-content">
                    <div class="card">
                        <div class="japanese-text" id="sentenceText"></div>
                        <div class="reading" id="sentenceReading"></div>
                        <div class="meaning" id="sentenceMeaning"></div>
                        <button class="audio-button" onclick="speak('sentence')">ğŸ”Š ë°œìŒ ë“£ê¸°</button>
                    </div>
                </div>

                <div id="kanji" class="tab-content">
                    <div class="card">
                        <div class="japanese-text" id="kanjiText"></div>
                        <div class="reading" id="kanjiReading"></div>
                        <div class="meaning" id="kanjiMeaning"></div>
                        <button class="audio-button" onclick="speak('kanji')">ğŸ”Š ë°œìŒ ë“£ê¸°</button>
                    </div>
                </div>

                <div id="kana" class="tab-content">
                    <div class="card">
                        <h3 style="text-align: center; margin-bottom: 20px; color: #667eea;">ì˜¤ëŠ˜ì˜ íˆë¼ê°€ë‚˜</h3>
                        <div class="japanese-text" id="hiraganaText"></div>
                        <div class="reading" id="hiraganaRomaji"></div>
                        <button class="audio-button" onclick="speakKana('hiragana')">ğŸ”Š ë°œìŒ ë“£ê¸°</button>
                    </div>
                    <div class="card">
                        <h3 style="text-align: center; margin-bottom: 20px; color: #764ba2;">ì˜¤ëŠ˜ì˜ ê°€íƒ€ì¹´ë‚˜</h3>
                        <div class="japanese-text" id="katakanaText"></div>
                        <div class="reading" id="katakanaRomaji"></div>
                        <button class="audio-button" onclick="speakKana('katakana')">ğŸ”Š ë°œìŒ ë“£ê¸°</button>
                    </div>
                </div>

                <div id="quiz" class="tab-content">
                    <div class="quiz-section">
                        <h3 style="text-align: center; margin-bottom: 20px;">ìµœê·¼ 2ì¼ê°„ ë°°ìš°ëŠ” ë‚´ìš© í‚¤ì¦ˆ</h3>
                        <div class="quiz-question" id="quizQuestion"></div>
                        <div class="quiz-options" id="quizOptions"></div>
                        <div class="quiz-result" id="quizResult"></div>
                        <button class="audio-button" onclick="nextQuiz()">ë‹¤ìŒ ë¬¸ì œ</button>
                    </div>
                </div>

                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="studyDays">0</div>
                        <div class="stat-label">í•™ìŠµì¼ìˆ˜</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="wordsLearned">0</div>
                        <div class="stat-label">í•™ìŠµ ë‹¨ì–´</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="quizScore">0%</div>
                        <div class="stat-label">í‚¤ì¦ˆ ì •ë‹µë¥ </div>
                    </div>
                </div>
            </div>

            <div class="calendar-section">
                <div class="calendar-header" id="calendarMonth"></div>
                <div class="calendar" id="calendar"></div>
            </div>
        </div>
    </div>

    <div class="modal" id="reviewModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 style="text-align: center; margin-bottom: 20px; color: #667eea;">ë³µì„í•˜ê¸°</h2>
            <div id="reviewContent"></div>
        </div>
    </div>

    <script>
        // í•™ìŠµ ë°ì´í„°
        const learningData = {
            '2025-01-07': {
                word: { text: 'æ¡œ', reading: 'ã•ãã‚‰', meaning: 'ë²¹ê½ƒ' },
                sentence: { text: 'æ¡œãŒç¶¿é±ã§ã™', reading: 'ã•ãã‚‰ãŒãã‚Œã„ã§ã™', meaning: 'ë²¹ê½ƒì´ ì•„ë¦„ë‹´ë‹ˆë‹¤' },
                kanji: { text: 'èŠ±', reading: 'ã¯ãª', meaning: 'ê½ƒ' },
                hiragana: { text: 'ã•', romaji: 'sa' },
                katakana: { text: 'ã‚µ', romaji: 'sa' }
            },
            '2025-01-08': {
                word: { text: 'å­¦æ ¡', reading: 'ãŒã£ã“ã†', meaning: 'í•™êµ' },
                sentence: { text: 'å­¦æ ¡ã«è¡Œãã¾ã™', reading: 'ãŒã£ã“ã†ã«ã„ãã¾ã™', meaning: 'í•™êµì— ê°€ë‹¤' },
                kanji: { text: 'å­¦', reading: 'ãŒã', meaning: 'ë°°ìš°ë‹¤' },
                hiragana: { text: 'ãŒ', romaji: 'ga' },
                katakana: { text: 'ã‚¬', romaji: 'ga' }
            },
            '2025-01-09': {
                word: { text: 'å‹é”', reading: 'ã¨ã‚‚ã ã¡', meaning: 'ì¹œêµ¬' },
                sentence: { text: 'å‹é”ã¨éŠã³ã¾ã™', reading: 'ã¨ã‚‚ã ã¡ã¨ã‚ãã³ã¾ã™', meaning: 'ì¹œêµ¬ì™€ ë†ë‹ˆë‹¤' },
                kanji: { text: 'å‹', reading: 'ã¨ã‚‚', meaning: 'ì¹œêµ¬' },
                hiragana: { text: 'ã¨', romaji: 'to' },
                katakana: { text: 'ãƒˆ', romaji: 'to' }
            },
            '2025-01-10': {
                word: { text: 'æœ¬', reading: 'ã»ã‚“', meaning: 'ì±…' },
                sentence: { text: 'æœ¬ã‚’èª­ã¿ã¾ã™', reading: 'ã»ã‚“ã‚’ã‚ˆã¿ã¾ã™', meaning: 'ì±…ì„ ì½ìŠµë‹ˆë‹¤' },
                kanji: { text: 'æœ¬', reading: 'ã»ã‚“', meaning: 'ì±…, ê¸°ë³¸' },
                hiragana: { text: 'ã»', romaji: 'ho' },
                katakana: { text: 'ãƒ›', romaji: 'ho' }
            }
        };

        // ì¶”ê°€ í•™ìŠµ ë°ì´í„° (ë§¤ì¼ ìˆœí™˜)
        const additionalData = [
            {
                word: { text: 'æœ', reading: 'ã‚ã•', meaning: 'ì•„ì¹˜ë§ˆ' },
                sentence: { text: 'æœã”é£¯ã‚’é£Ÿã¹ã¾ã™', reading: 'ã‚ã•ã”ã¯ã‚“ã‚’ãŸã¹ã¾ã™', meaning: 'ì•„ì¹˜ë§ˆë¹„ë¥¼ ë¨¹ìŠµë‹ˆë‹¤' },
                kanji: { text: 'æœ', reading: 'ã‚ã•', meaning: 'ì•„ì¹˜ë§ˆ' },
                hiragana: { text: 'ã‚', romaji: 'a' },
                katakana: { text: 'ã‚¢', romaji: 'a' }
            },
            {
                word: { text: 'å¤œ', reading: 'ã‚ˆã‚‹', meaning: 'ë°¤' },
                sentence: { text: 'å¤œã¯é™ã‹ã§ã™', reading: 'ã‚ˆã‚‹ã¯ã—ãšã‹ã§ã™', meaning: 'ë°¤ì€ ì¡°ìš©í•©ë‹ˆë‹¤' },
                kanji: { text: 'å¤œ', reading: 'ã‚ˆã‚‹', meaning: 'ë°¤' },
                hiragana: { text: 'ã‚ˆ', romaji: 'yo' },
                katakana: { text: 'ãƒ¨', romaji: 'yo' }
            },
            {
                word: { text: 'æ°´', reading: 'ã¿ãš', meaning: 'ë¬¼' },
                sentence: { text: 'æ°´ã‚’é£²ã¿ã¾ã™', reading: 'ã¿ãšã‚’ã®ã¿ã¾ã™', meaning: 'ë¬¼ì„ ë§ˆì…ë‹ˆë‹¤' },
                kanji: { text: 'æ°´', reading: 'ã¿ãš', meaning: 'ë¬¼' },
                hiragana: { text: 'ã¿', romaji: 'mi' },
                katakana: { text: 'ãƒŸ', romaji: 'mi' }
            },
            {
                word: { text: 'å±±', reading: 'ã‚„ã¾', meaning: 'ì‚°' },
                sentence: { text: 'å±±ã«ç™»ã‚Šã¾ã™', reading: 'ã‚„ã¾ã«ã®ã¼ã‚Šã¾ã™', meaning: 'ì‚°ì— ì˜¬ë¦°ë‹¤' },
                kanji: { text: 'å±±', reading: 'ã‚„ã¾', meaning: 'ì‚°' },
                hiragana: { text: 'ã‚„', romaji: 'ya' },
                katakana: { text: 'ãƒ¤', romaji: 'ya' }
            },
            {
                word: { text: 'é›¨', reading: 'ã‚ã‚', meaning: 'ë¹„' },
                sentence: { text: 'é›¨ãŒé™ã‚Šã¾ã™', reading: 'ã‚ã‚ãŒãµã‚Šã¾ã™', meaning: 'ë¹„ê°€ ë‚´ë¦°ë‹¤' },
                kanji: { text: 'é›¨', reading: 'ã‚ã‚', meaning: 'ë¹„' },
                hiragana: { text: 'ã‚', romaji: 'me' },
                katakana: { text: 'ãƒ¡', romaji: 'me' }
            }
        ];

        // ë©”ëª¨ë¦¬ ì €ì¥ì†Œ (localStorage ëŒ€ì²´)
        let memoryStorage = JSON.parse(localStorage.getItem('jpMemory') || '{"studyDays":0,"wordsLearned":0,"quizCorrect":0,"quizTotal":0,"studyHistory":{}}');

        // í˜„ì¬ ë‚ ì§œ ê°€ì ¸ì˜¤ê¸°
        function getCurrentDate() {
            return new Date().toISOString().split('T')[0];
        }

        // ë‚ ì§œ í‘œì‹œ
        function displayDate() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            document.getElementById('dateDisplay').textContent = now.toLocaleDateString('ko-KR', options);
        }

        // ì˜¤ëŠ˜ì˜ í•™ìŠµ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        function getTodayData() {
            const today = getCurrentDate();
            if (!learningData[today]) {
                // ë‚ ì§œì— ë”°ë¼ ì¶”ê°€ ë°ì´í„°ì—ì„œ ìˆœí™˜ ì„ íƒ
                const dayIndex = new Date().getDate() % additionalData.length;
                learningData[today] = additionalData[dayIndex];
            }
            return learningData[today];
        }

        // í•™ìŠµ ë‚´ìš© í‘œì‹œ
        function displayLearningContent() {
            const todayData = getTodayData();
            
            // ë‹¨ì–´
            document.getElementById('wordText').textContent = todayData.word.text;
            document.getElementById('wordReading').textContent = todayData.word.reading;
            document.getElementById('wordMeaning').textContent = todayData.word.meaning;
            
            // ë¬¸ì¥
            document.getElementById('sentenceText').textContent = todayData.sentence.text;
            document.getElementById('sentenceReading').textContent = todayData.sentence.reading;
            document.getElementById('sentenceMeaning').textContent = todayData.sentence.meaning;
            
            // í•œì
            document.getElementById('kanjiText').textContent = todayData.kanji.text;
            document.getElementById('kanjiReading').textContent = `ìŒë„: ${todayData.kanji.reading}`;
            document.getElementById('kanjiMeaning').textContent = todayData.kanji.meaning;
            
            // íˆë¼ê°€ë‚˜/ê°€íƒ€ì¹´ë‚˜
            document.getElementById('hiraganaText').textContent = todayData.hiragana.text;
            document.getElementById('hiraganaRomaji').textContent = todayData.hiragana.romaji;
            document.getElementById('katakanaText').textContent = todayData.katakana.text;
            document.getElementById('katakanaRomaji').textContent = todayData.katakana.romaji;
            
            // í•™ìŠµ ê¸°ë¡ ì €ì¥
            saveStudyRecord();
        }

        // í•™ìŠµ ê¸°ë¡ ì €ì¥
        function saveStudyRecord() {
            const today = getCurrentDate();
            if (!memoryStorage.studyHistory[today]) {
                memoryStorage.studyHistory[today] = getTodayData();
                memoryStorage.studyDays = Object.keys(memoryStorage.studyHistory).length;
                memoryStorage.wordsLearned = memoryStorage.studyDays * 3; // í•˜ë£¨ì— 3ê°œ ë‹¨ì–´ í•™ìŠµ
                updateStats();
            }
        }

                // í† ê¸ˆ ì—…ë°ì´íŠ¸
        function updateStats() {
            document.getElementById('studyDays').textContent = memoryStorage.studyDays;
            document.getElementById('wordsLearned').textContent = memoryStorage.wordsLearned;
            
            if (memoryStorage.quizTotal > 0) {
                const percentage = Math.round((memoryStorage.quizCorrect / memoryStorage.quizTotal) * 100);
                document.getElementById('quizScore').textContent = percentage + '%';
            }
            localStorage.setItem('jpMemory', JSON.stringify(memoryStorage));
        }

        // íƒ­ ì „í™˜
        function showTab(button, tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-button');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            button.classList.add('active');
            
            if (tabName === 'quiz') {
                initQuiz();
            }
        }

        // ìŒì„± í•µì„±
        function speak(type) {
            const todayData = getTodayData();
            let text = '';
            
            switch(type) {
                case 'word':
                    text = todayData.word.reading;
                    break;
                case 'sentence':
                    text = todayData.sentence.reading;
                    break;
                case 'kanji':
                    text = todayData.kanji.reading;
                    break;
            }
            
            if ('speechSynthesis' in window) {
                // ì´ì „ ìŒì„± ì¤‘ì§€
                window.speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP';
                utterance.rate = 0.8;
                
                // ì¼ë³¸ì–´ ìŒì„± ì°¾ê¸°
                const voices = window.speechSynthesis.getVoices();
                const japaneseVoice = voices.find(voice => voice.lang.includes('ja'));
                if (japaneseVoice) {
                    utterance.voice = japaneseVoice;
                }
                
                window.speechSynthesis.speak(utterance);
            } else {
                alert('ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± í•µì„±ì„ ì§„í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        }

        // ê°€ë‚˜ ìŒì„±
        function speakKana(type) {
            const todayData = getTodayData();
            const text = type === 'hiragana' ? todayData.hiragana.text : todayData.katakana.text;
            
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP';
                utterance.rate = 0.6;
                
                const voices = window.speechSynthesis.getVoices();
                const japaneseVoice = voices.find(voice => voice.lang.includes('ja'));
                if (japaneseVoice) {
                    utterance.voice = japaneseVoice;
                }
                
                window.speechSynthesis.speak(utterance);
            }
        }

        // ë‹¬ëŸ¬ê¸° ìƒì„±
        function createCalendar() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();
            const today = now.getDate();
            
            // ì›” í‘œì‹œ
            const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
            document.getElementById('calendarMonth').textContent = `${year}ë…„ ${monthNames[month]}`;
            
            const calendar = document.getElementById('calendar');
            calendar.innerHTML = '';
            
            // ìš”ì¼ í‘œì‹œ
            const weekdays = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
            weekdays.forEach(day => {
                const dayLabel = document.createElement('div');
                dayLabel.className = 'weekday-label';
                dayLabel.textContent = day;
                calendar.appendChild(dayLabel);
            });
            
            // ë¹ˆ ì¹¸ ì±„ì›Œê¸°
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                calendar.appendChild(emptyDay);
            }
            
            // ë‚ ì§œ ì±„ì›Œê¸°
            for (let date = 1; date <= lastDate; date++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = date;
                
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(date).padStart(2, '0')}`;
                
                if (learningData[dateStr] || memoryStorage.studyHistory[dateStr]) {
                    dayElement.classList.add('has-data');
                }
                
                if (date === today) {
                    dayElement.classList.add('today');
                }
                
                dayElement.onclick = () => showReview(dateStr);
                calendar.appendChild(dayElement);
            }
        }

        // ë³µì„ ëª©ë¡ í‘œì‹œ
        function showReview(dateStr) {
            const data = learningData[dateStr] || memoryStorage.studyHistory[dateStr];
            if (!data) {
                alert('ì´ ë‚ ì§œì—ëŠ” í•™ìŠµ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const modal = document.getElementById('reviewModal');
            const content = document.getElementById('reviewContent');
            
            content.innerHTML = `
                <div class="card">
                    <h3>ë‹¨ì–´</h3>
                    <div class="japanese-text">${data.word.text}</div>
                    <div class="reading">${data.word.reading}</div>
                    <div class="meaning">${data.word.meaning}</div>
                </div>
                <div class="card">
                    <h3>ë¬¸ì¥</h3>
                    <div class="japanese-text">${data.sentence.text}</div>
                    <div class="reading">${data.sentence.reading}</div>
                    <div class="meaning">${data.sentence.meaning}</div>
                </div>
                <div class="card">
                    <h3>í•œì</h3>
                    <div class="japanese-text">${data.kanji.text}</div>
                    <div class="reading">ìŒë„: ${data.kanji.reading}</div>
                    <div class="meaning">${data.kanji.meaning}</div>
                </div>
            `;
            
            modal.style.display = 'block';
        }

        // ëª©ë¡ ë‹«ê¸°
        function closeModal() {
            document.getElementById('reviewModal').style.display = 'none';
        }

        // í‚¤ì¦ˆ ë³€ìˆ˜
        let currentQuizData = [];
        let currentQuizIndex = 0;
        let currentQuizAnswer = '';

        // í‚¤ì¦ˆ ì´ˆê¸°í™”
        function initQuiz() {
            currentQuizData = [];
            const today = new Date();
            
            // ìµœê·¼ 2ì¼ê°„ì˜ ë°ì´í„° ìˆ˜ì§‘
            for (let i = 0; i <= 2; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                
                if (learningData[dateStr] || memoryStorage.studyHistory[dateStr]) {
                    const data = learningData[dateStr] || memoryStorage.studyHistory[dateStr];
                    currentQuizData.push({
                        question: data.word.text,
                        answer: data.word.meaning,
                        type: 'word'
                    });
                    currentQuizData.push({
                        question: data.kanji.text,
                        answer: data.kanji.meaning,
                        type: 'kanji'
                    });
                }
            }
            
            if (currentQuizData.length > 0) {
                currentQuizIndex = 0;
                showQuizQuestion();
            } else {
                document.getElementById('quizQuestion').textContent = 'ì•„ì§ í‚¤ì¦ˆë¥¼ í‘¸ë ¥ ìˆ˜ ìˆëŠ” í•™ìŠµ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.';
                document.getElementById('quizOptions').innerHTML = '';
                document.getElementById('quizResult').textContent = '';
            }
        }

        // í‚¤ì¦ˆ ë¬¸ì œ í‘œì‹œ
        function showQuizQuestion() {
            if (currentQuizIndex >= currentQuizData.length) {
                currentQuizIndex = 0;
            }
            
            const quiz = currentQuizData[currentQuizIndex];
            currentQuizAnswer = quiz.answer;
            
            document.getElementById('quizQuestion').textContent = `"${quiz.question}"ì˜ ë”°ìœ„ëŠ”?`;
            document.getElementById('quizResult').textContent = '';
            
            // ì„ íƒì§€ ìƒì„±
            const options = [quiz.answer];
            const wrongAnswers = ['ì‚¬ë‘', 'í•˜ëŠ˜', 'ë°”ë‹¤', 'ì‹œê°„', 'ë§ˆìŒ', 'ê¸¸', 'ì§‘', 'ì‚¬ëŒ', 'ìŒì‹', 'ë‚¤ì”¨'];
            
            while (options.length < 4) {
                const wrongAnswer = wrongAnswers[Math.floor(Math.random() * wrongAnswers.length)];
                if (!options.includes(wrongAnswer)) {
                    options.push(wrongAnswer);
                }
            }
            
            // ì„ íƒì§€ ì„ê¸°
            options.sort(() => Math.random() - 0.5);
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            options.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option';
                optionElement.textContent = option;
                optionElement.onclick = () => checkAnswer(option, optionElement);
                optionsContainer.appendChild(optionElement);
            });
        }

        // ë‹µ ì²´í¬
        function checkAnswer(answer, element) {
            const options = document.querySelectorAll('.quiz-option');
            options.forEach(opt => opt.onclick = null);
            
            if (answer === currentQuizAnswer) {
                element.classList.add('correct');
                document.getElementById('quizResult').textContent = 'ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰';
                memoryStorage.quizCorrect++;
            } else {
                element.classList.add('incorrect');
                options.forEach(opt => {
                    if (opt.textContent === currentQuizAnswer) {
                        opt.classList.add('correct');
                    }
                });
                document.getElementById('quizResult').textContent = `íŠµë‹¹ì…ë‹ˆë‹¤. ì •ë‹µì€ "${currentQuizAnswer}"ì…ë‹ˆë‹¤.`;
            }
            
            memoryStorage.quizTotal++;
            updateStats();
        }

        // ë‹¤ìŒ í‚¤ì¦ˆ
        function nextQuiz() {
            currentQuizIndex++;
            showQuizQuestion();
        }

        // ì´ˆê¸°í™”
        window.onload = function() {
            displayDate();
            displayLearningContent();
            createCalendar();
            updateStats();
            
            // ìŒì„± ì¤€ë¹„
            if ('speechSynthesis' in window) {
                window.speechSynthesis.getVoices();
            }
            
            // ëª©ë¡ ì™¸ë¶€ í´ë¦½ì‹œ ë‹«ê¸°
            window.onclick = function(event) {
                const modal = document.getElementById('reviewModal');
                if (event.target === modal) {
                    closeModal();
                }
            }
        };
    </script>
</body>
</html>
